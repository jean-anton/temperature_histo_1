/*! coi-serviceworker v0.1.7 - MIT License */
if (typeof window === "undefined") { self.addEventListener("install", () => self.skipWaiting()); self.addEventListener("activate", e => e.waitUntil(self.clients.claim())); self.addEventListener("fetch", e => { if (e.request.cache === "only-if-cached" && e.request.mode !== "same-origin") return; e.respondWith(fetch(e.request).then(r => { if (r.status === 0) return r; const h = new Headers(r.headers); h.set("Cross-Origin-Embedder-Policy", r.url.endsWith(".html") ? "credentialless" : "require-corp"); h.set("Cross-Origin-Opener-Policy", "same-origin"); return new Response(r.body, { status: r.status, statusText: r.statusText, headers: h }) }).catch(e => console.error(e))) }); } else { (() => { const n = window.navigator.serviceWorker; if (n && n.controller && n.controller.src.includes("coi-serviceworker")) { n.controller.postMessage("ping"); } if (window.crossOriginIsolated !== false || !n) return; let r = !1; const i = () => r || (r = !0, window.location.reload()); n.register(window.document.currentScript.src).then(t => { t.addEventListener("updatefound", () => i()); if (t.active && !n.controller) i(); }, e => console.error("COI registration failed: ", e)); })(); }
